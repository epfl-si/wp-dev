# docker-compose.yml for running a local copy of the WordPress stack
#
# Unlike the real thing, there is no Varnish (but there is phpmyadmin)
#
# This docker-compose.yml file works hand-to-hand with the Makefie,
# which ensures that all required images are built, and code
# repositories are checked out.
#
# docker compose automatically sources the .env file if it exists
# (see https://docs.docker.com/compose/environment-variables/#the-env-file);
# this is what makes the ${VARIABLE} expansions below work.

version: '3'

services:

  db:
    container_name: wp-db
    image: mariadb:11.4
    environment:
      - MARIADB_ROOT_PASSWORD=${MARIADB_ROOT_PASSWORD}
    ports:
      - 3306:3306
    volumes:
      - /var/lib/mysql

  phpmyadmin:
    container_name: wp-pma
    image: phpmyadmin/phpmyadmin
    environment:
      - PMA_ARBITRARY=1
    ports:
      - ${WP_PORT_PHPMA}:80
    volumes:
      - /sessions

  menu-api:
    container_name: menu-api
    build: menu-api
